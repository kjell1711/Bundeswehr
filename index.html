<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bundeswehr Role-Play - Ausbildungspanel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #006633; /* Bundeswehrgrün */
            --secondary: #4B5320; /* Feldgrau */
            --accent: #FFCC00; /* Bundeswehrgelb */
            --dark: #1a1f1c;
            --light: #f8f9fa;
            --gray: #6c757d;
            --success: #28a745;
            --danger: #dc3545;
            --info: #17a2b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #111;
            color: var(--light);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 250px;
            background: linear-gradient(to bottom, var(--dark), var(--secondary));
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            box-shadow: 5px 0 15px rgba(0,0,0,0.5);
            z-index: 100;
        }

        .logo {
            text-align: center;
            padding: 20px 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo h2 {
            color: var(--accent);
            font-size: 1.4rem;
            letter-spacing: 1px;
        }

        .logo p {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 5px;
        }

        .nav-menu {
            list-style: none;
            flex-grow: 1;
        }

        .nav-item {
            margin: 5px 15px;
            border-radius: 8px;
            overflow: hidden;
        }

        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 15px;
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s;
        }

        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .nav-link i {
            width: 30px;
            font-size: 1.2rem;
            margin-right: 10px;
            color: var(--accent);
        }

        .nav-item.active .nav-link {
            color: var(--accent);
            font-weight: bold;
            border-left: 4px solid var(--accent);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: radial-gradient(ellipse at top, #222, #111);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            color: var(--accent);
            font-size: 1.8rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: rgba(0,0,0,0.3);
            padding: 8px 15px;
            border-radius: 20px;
        }

        .user-info i {
            color: var(--accent);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Dashboard Tab */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background-color: rgba(30, 35, 32, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border-left: 4px solid var(--primary);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .card-header h3 {
            color: var(--accent);
        }

        .promotion-item {
            background-color: rgba(0,0,0,0.2);
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .promotion-item.unread {
            border-left: 4px solid var(--info);
        }

        .promotion-info {
            flex-grow: 1;
        }

        .promotion-actions button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background-color 0.3s;
        }

        .promotion-actions button:hover {
            background-color: var(--success);
        }

        /* Ankündigungen Tab */
        .announcement-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }

        .announcement-btn {
            background: linear-gradient(to right, var(--secondary), var(--primary));
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .announcement-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .announcement-btn i {
            margin-right: 10px;
        }

        .copy-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            display: none;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Users Tab */
        .user-search {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .user-search input {
            flex-grow: 1;
            padding: 12px 15px;
            border-radius: 6px;
            border: 1px solid rgba(255,255,255,0.2);
            background-color: rgba(0,0,0,0.3);
            color: white;
        }

        .user-search button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .users-list {
            background-color: rgba(30, 35, 32, 0.8);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .user-item:last-child {
            border-bottom: none;
        }

        .user-info-small {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-rank {
            background-color: var(--primary);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            min-width: 100px;
            text-align: center;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .user-actions button {
            padding: 8px 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .promote-btn {
            background-color: var(--success);
            color: white;
        }

        .demote-btn {
            background-color: var(--danger);
            color: white;
        }

        /* Settings Tab */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .setting-item {
            background-color: rgba(30, 35, 32, 0.8);
            border-radius: 10px;
            padding: 20px;
        }

        .setting-item h3 {
            color: var(--accent);
            margin-bottom: 15px;
        }

        .setting-item input, .setting-item select {
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid rgba(255,255,255,0.2);
            background-color: rgba(0,0,0,0.3);
            color: white;
            margin-bottom: 15px;
        }

        .save-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .save-btn:hover {
            background-color: var(--success);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 10px 0;
                flex-direction: row;
                justify-content: space-between;
            }
            
            .logo {
                padding: 10px;
                border-bottom: none;
                margin-bottom: 0;
            }
            
            .logo h2 {
                font-size: 1.2rem;
            }
            
            .nav-menu {
                display: flex;
                flex-grow: 0;
            }
            
            .nav-item {
                margin: 0 5px;
            }
            
            .nav-link span {
                display: none;
            }
            
            .nav-link i {
                margin-right: 0;
            }
            
            .main-content {
                padding: 15px;
            }
        }

        /* Helper Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <div class="logo">
            <h2><i class="fas fa-shield-alt"></i> Bundeswehr RP</h2>
            <p>Ausbildungspanel v1.0</p>
        </div>
        
        <ul class="nav-menu">
            <li class="nav-item active" data-tab="dashboard">
                <a href="#" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item" data-tab="announcements">
                <a href="#" class="nav-link">
                    <i class="fas fa-bullhorn"></i>
                    <span>Ankündigungen</span>
                </a>
            </li>
            <li class="nav-item" data-tab="users">
                <a href="#" class="nav-link">
                    <i class="fas fa-users"></i>
                    <span>Benutzer</span>
                </a>
            </li>
            <li class="nav-item" data-tab="settings">
                <a href="#" class="nav-link">
                    <i class="fas fa-cog"></i>
                    <span>Einstellungen</span>
                </a>
            </li>
        </ul>
        
        <div class="logo">
            <p style="font-size: 0.7rem;">Bundeswehr Role-Play</p>
            <p style="font-size: 0.7rem; color: var(--accent);">Authentisches Ausbildungspanel</p>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <div class="header">
            <h1 id="page-title">Dashboard</h1>
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
                <span>Ausbilder</span>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-header">
                        <h3>Letzte Beförderungen</h3>
                        <i class="fas fa-medal"></i>
                    </div>
                    <div id="promotions-list">
                        <!-- Promotion items will be loaded here -->
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Systemstatistik</h3>
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div>
                        <p><i class="fas fa-users"></i> Benutzer in Datenbank: <span id="user-count">0</span></p>
                        <p><i class="fas fa-bullhorn"></i> Ankündigungen: <span id="announcement-count">12</span></p>
                        <p><i class="fas fa-clock"></i> Letzte Aktualisierung: <span id="last-update">Heute</span></p>
                    </div>
                </div>
            </div>
            
            <div class="card mt-20">
                <div class="card-header">
                    <h3>Schnellzugriff</h3>
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="announcement-buttons">
                    <button class="announcement-btn" data-text="AGA Ankündigung">
                        <i class="fas fa-copy"></i> AGA Ankündigung kopieren
                    </button>
                    <button class="announcement-btn" data-text="Dienstantritt">
                        <i class="fas fa-copy"></i> Dienstantritt kopieren
                    </button>
                    <button class="announcement-btn" data-text="Beförderungsansprache">
                        <i class="fas fa-copy"></i> Beförderungsansprache kopieren
                    </button>
                </div>
            </div>
        </div>

        <!-- Announcements Tab -->
        <div id="announcements" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3>Ankündigungen & Skripte</h3>
                    <i class="fas fa-scroll"></i>
                </div>
                <p class="mb-20">Klicken Sie auf eine Ankündigung, um den Text in die Zwischenablage zu kopieren.</p>
                
                <div class="announcement-buttons">
                    <!-- Announcement buttons will be generated dynamically -->
                </div>
            </div>
        </div>

        <!-- Users Tab -->
        <div id="users" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h3>Benutzerverwaltung</h3>
                    <i class="fas fa-user-edit"></i>
                </div>
                
                <div class="user-search">
                    <input type="text" id="user-search-input" placeholder="Benutzername suchen (z.B. kl1777)">
                    <button id="search-user-btn">Suchen</button>
                </div>
                
                <div id="user-result" class="hidden">
                    <!-- User search result will appear here -->
                </div>
                
                <div id="users-list" class="users-list">
                    <!-- Users will be loaded here -->
                </div>
                
                <div id="user-edit-form" class="hidden mt-20">
                    <!-- User edit form will appear here -->
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="settings-grid">
                <div class="setting-item">
                    <h3>Panel-Einstellungen</h3>
                    <label for="theme-select">Theme:</label>
                    <select id="theme-select">
                        <option value="dark">Dunkel (Standard)</option>
                        <option value="light">Hell</option>
                        <option value="military">Militär Grün</option>
                    </select>
                    
                    <label for="items-per-page">Einträge pro Seite:</label>
                    <input type="number" id="items-per-page" value="10" min="5" max="50">
                    
                    <button class="save-btn">Einstellungen speichern</button>
                </div>
                
                <div class="setting-item">
                    <h3>Datenbank-Verbindung</h3>
                    <p>Status: <span id="db-status" style="color: var(--accent);">Verbunden</span></p>
                    <p>URL: bxgkgqnoebjoshkuaidq.supabase.co</p>
                    <p>API-Schlüssel: *******_mVlYGYRn</p>
                    
                    <button id="refresh-db-btn" class="save-btn">Datenbank aktualisieren</button>
                </div>
                
                <div class="setting-item">
                    <h3>Bundeswehr Ränge</h3>
                    <div id="ranks-list">
                        <!-- Ranks will be listed here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Copy Notification -->
        <div id="copy-notification" class="copy-notification">
            <i class="fas fa-check-circle"></i> Text wurde in die Zwischenablage kopiert!
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://bxgkgqnoebjoshkuaidq.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4Z2tncW5vZWJqb3Noa3VhaWRxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjU5NjQxNDUsImV4cCI6MjA0MTU0MDE0NX0.Qd2vCzcC7XJZaND_GmD8rA_mVlYGYRn';
        
        // Initialize Supabase client
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        
        // Bundeswehr Ränge in aufsteigender Reihenfolge
        const ranks = [
            "Schütze",
            "Gefreiter",
            "Obergefreiter",
            "Hauptgefreiter",
            "Stabsgefreiter",
            "Oberstabsgefreiter",
            "Unteroffizier",
            "Stabsunteroffizier",
            "Feldwebel",
            "Oberfeldwebel",
            "Hauptfeldwebel",
            "Stabsfeldwebel",
            "Oberstabsfeldwebel",
            "Leutnant",
            "Oberleutnant",
            "Hauptmann",
            "Major",
            "Oberstleutnant",
            "Oberst",
            "Brigadegeneral",
            "Generalmajor",
            "Generalleutnant",
            "General"
        ];
        
        // Announcement texts
        const announcements = {
            "AGA Ankündigung": `Willkommen bei der AGA (Allgemeine Grundausbildung) der Bundeswehr!

Dies ist die Grundausbildung der Bundeswehr. Hier lernen Sie die Grundlagen des militärischen Dienstes.

Ablauf der AGA:
1. Begrüßung und Einweisung
2. Grundlagen der militärischen Ordnung
3. Ausbildung an der Waffe
4. Körperliche Ertüchtigung
5. Theoretische Ausbildung

Wichtige Kommandos:
- "Achtung!" - Grundstellung
- "Rechts um!" - Rechtswendung
- "Links um!" - Linkswendung
- "Kehrt!" - Kehrtwendung
- "Im Gleichschritt... Marsch!" - Marschbeginn
- "Halt!" - Marschstopp

Ab sofort antworten Sie mit "Jawohl, Herr Ausbilder!" oder "Jawohl, Frau Ausbilder!"

Die AGA dauert 4 Wochen. Bei erfolgreichem Abschluss werden Sie zum Gefreiten befördert.

Viel Erfolg!`,
            
            "Dienstantritt": `Dienstantritt Bundeswehr Role-Play

Sehr geehrte Rekrutin, sehr geehrter Rekrut,

herzlich willkommen zum Dienstantritt bei der Bundeswehr im Role-Play.

Ihre erste Aufgabe ist die Meldung bei Ihrer Einheit. Bitte begeben Sie sich unverzüglich zum Kompaniegefechtsstand und melden Sie sich beim diensthabenden Unteroffizier.

Mit dem heutigen Tag beginnen Sie Ihre militärische Laufbahn. Erwartet werden:
- Pünktlichkeit
- Disziplin
- Kameradschaft
- Einsatzbereitschaft

Die Dienstuniform ist korrekt zu tragen. Vergessen Sie nicht Ihre Erkennungsmarke.

Bei Fragen wenden Sie sich an Ihren Gruppenführer.

Mit kameradschaftlichen Grüßen
Ihr Ausbildungspersonal`,
            
            "Beförderungsansprache": `Beförderungsansprache

Kameradinnen und Kameraden,

im Namen der Bundeswehr darf ich Ihnen zur Beförderung gratulieren.

Sie haben in der vergangenen Zeit bewiesen, dass Sie den Anforderungen des Dienstes gewachsen sind. Ihr Einsatz, Ihre Disziplin und Ihre Kameradschaft wurden von Ihren Vorgesetzten anerkannt.

Mit Ihrer neuen Dienstgradstellung übernehmen Sie mehr Verantwortung. Sie sind nun Vorbild für die Rekruten und unterstellten Soldaten.

Die Beförderung ist nicht nur ein Privileg, sondern vor allem eine Verpflichtung. Verpflichtung gegenüber der Truppe, gegenüber Ihren Kameraden und gegenüber unserem Staat.

Tragen Sie Ihren neuen Dienstgrad mit Stolz, aber auch mit der Demut, die einem Soldaten der Bundeswehr gebührt.

Ich wünsche Ihnen weiterhin viel Erfolg und alles Gute für Ihren weiteren Dienst.

Glück ab!`,
            
            "Marschbefehl": `Marschbefehl

An alle Soldaten der Einheit!

Es folgt der Marschbefehl für die Übung "Eichenlaub".

Aufstellung: 08:30 Uhr am Sammelplatz Alpha
Ausrückung: 09:00 Uhr
Marschroute: Sammelplatz Alpha -> Wegpunkt Bravo -> Wegpunkt Charlie -> Zielpunkt Delta
Marschgeschwindigkeit: 5 km/h
Pausen: 10 Minuten nach jeder Stunde
Ausrüstung: Vollausrüstung, Feldflasche gefüllt, Verpflegung für 6 Stunden

Besondere Anweisungen:
- Funkstille bis Wegpunkt Bravo
- Tarnung ab Wegpunkt Charlie
- Gefechtsberührung möglich ab Wegpunkt Charlie

Der Marschführer ist Hauptfeldwebel Mustermann.

Bei Verwundung: Sofort Meldung an den Sanitäter.

Für die Bundeswehr!
Der Einheitsführer`,
            
            "Gefechtsübung": `Ankündigung Gefechtsübung

ACHTUNG! GEFECHTSÜBUNG "STURMWIND"

Zeit: Heute, 15:00 Uhr
Ort: Übungsgelände Nord
Teilnehmer: 1. - 3. Zug
Ziel: Übung der defensiven Gefechtsführung

Ablauf:
1. Einweisen in die Lage (15:00-15:15)
2. Beziehen der Stellungen (15:15-15:45)
3. Abwehr des gegnerischen Angriffs (16:00-17:00)
4. Gegenstoß (17:15-17:45)
5. Übungsnachbesprechung (18:00)

Ausrüstung:
- Übungswaffen (gekennzeichnet)
- Schutzausrüstung (Helm, Weste)
- Tarnkleidung
- Übungsmunition (Simunitions)

Sicherheitsbestimmungen:
- Waffen niemals auf Personen richten
- Sicherheitsabstand von 10 Metern
- Bei "Übungsabbruch" sofort alle Aktivitäten einstellen

Die Übung wird bewertet. Besonderes Augenmerk auf:
- Kommunikation innerhalb der Gruppe
- Deckungswechsel
- Feuer und Bewegung

Führen Sie sich und Ihre Kameraden verantwortungsvoll!

Der Übungsleiter
Major Schneider`
        };
        
        // DOM Elements
        let currentUser = null;
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Tab navigation
            setupTabNavigation();
            
            // Load initial data
            loadDashboardData();
            loadUsers();
            setupAnnouncementButtons();
            displayRanks();
            
            // Setup event listeners
            document.getElementById('search-user-btn').addEventListener('click', searchUser);
            document.getElementById('user-search-input').addEventListener('keyup', function(e) {
                if (e.key === 'Enter') searchUser();
            });
            
            document.getElementById('refresh-db-btn').addEventListener('click', function() {
                loadUsers();
                loadDashboardData();
                showNotification('Datenbank aktualisiert!');
            });
            
            // Theme selector
            document.getElementById('theme-select').addEventListener('change', function() {
                const theme = this.value;
                document.body.className = theme;
                showNotification('Theme geändert zu: ' + theme);
            });
        });
        
        // Tab Navigation Setup
        function setupTabNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            const tabContents = document.querySelectorAll('.tab-content');
            const pageTitle = document.getElementById('page-title');
            
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all tabs
                    navItems.forEach(nav => nav.classList.remove('active'));
                    tabContents.forEach(tab => tab.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                    
                    // Update page title
                    const tabName = this.querySelector('span').textContent;
                    pageTitle.textContent = tabName;
                    
                    // Load data for the tab if needed
                    if (tabId === 'users') {
                        loadUsers();
                    } else if (tabId === 'dashboard') {
                        loadDashboardData();
                    }
                });
            });
        }
        
        // Load Dashboard Data
        async function loadDashboardData() {
            // In a real app, you would fetch this from Supabase
            // For now, we'll use mock data
            
            const promotions = [
                { id: 1, username: 'kl1777', oldRank: 'Gefreiter', newRank: 'Obergefreiter', timestamp: '2023-10-15 14:30', read: false },
                { id: 2, username: 'Soldat123', oldRank: 'Schütze', newRank: 'Gefreiter', timestamp: '2023-10-14 11:20', read: false },
                { id: 3, username: 'Panzerfahrer', oldRank: 'Hauptgefreiter', newRank: 'Stabsgefreiter', timestamp: '2023-10-13 16:45', read: true },
                { id: 4, username: 'FallschirmJA', oldRank: 'Obergefreiter', newRank: 'Hauptgefreiter', timestamp: '2023-10-12 09:15', read: false }
            ];
            
            const promotionsList = document.getElementById('promotions-list');
            promotionsList.innerHTML = '';
            
            promotions.forEach(promo => {
                const promoItem = document.createElement('div');
                promoItem.className = `promotion-item ${promo.read ? '' : 'unread'}`;
                promoItem.innerHTML = `
                    <div class="promotion-info">
                        <strong>${promo.username}</strong><br>
                        <small>${promo.oldRank} → ${promo.newRank}</small><br>
                        <small>${promo.timestamp}</small>
                    </div>
                    <div class="promotion-actions">
                        ${!promo.read ? `<button onclick="markPromotionAsRead(${promo.id})">Als gelesen markieren</button>` : '<span style="color: var(--success);"><i class="fas fa-check"></i> Gelesen</span>'}
                    </div>
                `;
                promotionsList.appendChild(promoItem);
            });
            
            // Update user count (mock)
            document.getElementById('user-count').textContent = '24';
            document.getElementById('last-update').textContent = new Date().toLocaleTimeString('de-DE');
        }
        
        // Load Users
        async function loadUsers() {
            // In a real app, you would fetch from Supabase
            // For now, we'll use mock data
            
            const mockUsers = [
                { id: 1, username: 'kl1777', rank: 'Obergefreiter' },
                { id: 2, username: 'Soldat123', rank: 'Gefreiter' },
                { id: 3, username: 'Panzerfahrer', rank: 'Stabsgefreiter' },
                { id: 4, username: 'FallschirmJA', rank: 'Hauptgefreiter' },
                { id: 5, username: 'BW_Fan22', rank: 'Schütze' },
                { id: 6, username: 'General_H', rank: 'Hauptmann' },
                { id: 7, username: 'Leopard2A7', rank: 'Oberfeldwebel' },
                { id: 8, username: 'GefechtsSim', rank: 'Unteroffizier' },
                { id: 9, username: 'Sanitäter77', rank: 'Stabsunteroffizier' },
                { id: 10, username: 'Fernmelder', rank: 'Feldwebel' }
            ];
            
            const usersList = document.getElementById('users-list');
            usersList.innerHTML = '';
            
            mockUsers.forEach(user => {
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                userItem.innerHTML = `
                    <div class="user-info-small">
                        <i class="fas fa-user"></i>
                        <span><strong>${user.username}</strong></span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <span class="user-rank">${user.rank}</span>
                        <div class="user-actions">
                            <button class="promote-btn" onclick="promoteUser('${user.username}', '${user.rank}')">Befördern</button>
                            <button class="demote-btn" onclick="demoteUser('${user.username}', '${user.rank}')">Degradieren</button>
                        </div>
                    </div>
                `;
                usersList.appendChild(userItem);
            });
        }
        
        // Setup Announcement Buttons
        function setupAnnouncementButtons() {
            const announcementsContainer = document.querySelector('#announcements .announcement-buttons');
            announcementsContainer.innerHTML = '';
            
            for (const [title, text] of Object.entries(announcements)) {
                const button = document.createElement('button');
                button.className = 'announcement-btn';
                button.innerHTML = `<i class="fas fa-copy"></i> ${title} kopieren`;
                button.setAttribute('data-text', title);
                
                button.addEventListener('click', function() {
                    copyToClipboard(announcements[title]);
                });
                
                announcementsContainer.appendChild(button);
            }
            
            // Also update the dashboard quick access buttons
            const dashboardButtons = document.querySelectorAll('#dashboard .announcement-btn');
            dashboardButtons.forEach(button => {
                const textKey = button.getAttribute('data-text');
                if (announcements[textKey]) {
                    button.addEventListener('click', function() {
                        copyToClipboard(announcements[textKey]);
                    });
                }
            });
        }
        
        // Copy to Clipboard Function
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('Text wurde in die Zwischenablage kopiert!');
            }).catch(err => {
                console.error('Fehler beim Kopieren: ', err);
                showNotification('Fehler beim Kopieren!', 'error');
            });
        }
        
        // Show Notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('copy-notification');
            notification.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> ${message}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Search User Function
        async function searchUser() {
            const username = document.getElementById('user-search-input').value.trim();
            if (!username) return;
            
            const userResult = document.getElementById('user-result');
            const editForm = document.getElementById('user-edit-form');
            
            // In a real app, you would search in Supabase
            // For now, we'll simulate a search
            
            // Mock user data
            const mockUser = { 
                id: 25, 
                username: username, 
                rank: 'Schütze',
                exists: Math.random() > 0.5 // Simulate 50/50 chance user exists
            };
            
            if (mockUser.exists) {
                // User exists - show current rank
                userResult.innerHTML = `
                    <div class="user-item">
                        <div class="user-info-small">
                            <i class="fas fa-user-check"></i>
                            <span><strong>${mockUser.username}</strong> gefunden</span>
                        </div>
                        <div>
                            <span class="user-rank">${mockUser.rank}</span>
                        </div>
                    </div>
                `;
                userResult.classList.remove('hidden');
                
                // Show edit form
                editForm.innerHTML = `
                    <div class="card">
                        <div class="card-header">
                            <h3>Benutzer bearbeiten: ${mockUser.username}</h3>
                        </div>
                        <div style="padding: 20px;">
                            <p>Aktueller Rang: <strong>${mockUser.rank}</strong></p>
                            <div class="user-actions" style="margin-top: 15px;">
                                <button class="promote-btn" onclick="promoteUser('${mockUser.username}', '${mockUser.rank}')">Befördern</button>
                                <button class="demote-btn" onclick="demoteUser('${mockUser.username}', '${mockUser.rank}')">Degradieren</button>
                            </div>
                        </div>
                    </div>
                `;
                editForm.classList.remove('hidden');
                
            } else {
                // User doesn't exist - show creation form
                userResult.innerHTML = `
                    <div class="user-item">
                        <div class="user-info-small">
                            <i class="fas fa-user-plus"></i>
                            <span><strong>${mockUser.username}</strong> nicht gefunden - Neuer Benutzer</span>
                        </div>
                    </div>
                `;
                userResult.classList.remove('hidden');
                
                // Show creation form
                editForm.innerHTML = `
                    <div class="card">
                        <div class="card-header">
                            <h3>Neuen Benutzer erstellen</h3>
                        </div>
                        <div style="padding: 20px;">
                            <p>Benutzername: <strong>${mockUser.username}</strong></p>
                            <label for="new-user-rank">Startrang wählen:</label>
                            <select id="new-user-rank" style="width: 100%; margin: 10px 0;">
                                ${ranks.map(rank => `<option value="${rank}">${rank}</option>`).join('')}
                            </select>
                            <button class="save-btn" onclick="createUser('${mockUser.username}')">Benutzer erstellen</button>
                        </div>
                    </div>
                `;
                editForm.classList.remove('hidden');
            }
        }
        
        // Promote User Function
        function promoteUser(username, currentRank) {
            const currentIndex = ranks.indexOf(currentRank);
            if (currentIndex < ranks.length - 1) {
                const newRank = ranks[currentIndex + 1];
                
                // In a real app, you would update in Supabase
                // and add a promotion record
                
                // Show success message
                showNotification(`${username} wurde von ${currentRank} zu ${newRank} befördert!`);
                
                // Add to promotion list (simulated)
                addPromotionToDashboard(username, currentRank, newRank);
                
                // Reload users
                setTimeout(() => {
                    loadUsers();
                    const userResult = document.getElementById('user-result');
                    const editForm = document.getElementById('user-edit-form');
                    userResult.classList.add('hidden');
                    editForm.classList.add('hidden');
                }, 1000);
            } else {
                showNotification(`${username} hat bereits den höchsten Rang!`, 'error');
            }
        }
        
        // Demote User Function
        function demoteUser(username, currentRank) {
            const currentIndex = ranks.indexOf(currentRank);
            if (currentIndex > 0) {
                const newRank = ranks[currentIndex - 1];
                
                // In a real app, you would update in Supabase
                
                // Show success message
                showNotification(`${username} wurde von ${currentRank} zu ${newRank} degradiert!`);
                
                // Reload users
                setTimeout(() => {
                    loadUsers();
                    const userResult = document.getElementById('user-result');
                    const editForm = document.getElementById('user-edit-form');
                    userResult.classList.add('hidden');
                    editForm.classList.add('hidden');
                }, 1000);
            } else {
                showNotification(`${username} hat bereits den niedrigsten Rang!`, 'error');
            }
        }
        
        // Create User Function
        function createUser(username) {
            const rankSelect = document.getElementById('new-user-rank');
            const selectedRank = rankSelect.value;
            
            // In a real app, you would insert into Supabase
            
            // Show success message
            showNotification(`Benutzer ${username} wurde mit Rang ${selectedRank} erstellt!`);
            
            // Clear forms
            setTimeout(() => {
                document.getElementById('user-search-input').value = '';
                const userResult = document.getElementById('user-result');
                const editForm = document.getElementById('user-edit-form');
                userResult.classList.add('hidden');
                editForm.classList.add('hidden');
                
                // Reload users to show the new one
                loadUsers();
            }, 1000);
        }
        
        // Add Promotion to Dashboard
        function addPromotionToDashboard(username, oldRank, newRank) {
            const promotionsList = document.getElementById('promotions-list');
            const promoItem = document.createElement('div');
            promoItem.className = 'promotion-item unread';
            promoItem.innerHTML = `
                <div class="promotion-info">
                    <strong>${username}</strong><br>
                    <small>${oldRank} → ${newRank}</small><br>
                    <small>${new Date().toLocaleString('de-DE')}</small>
                </div>
                <div class="promotion-actions">
                    <button onclick="markPromotionAsRead(${Date.now()})">Als gelesen markieren</button>
                </div>
            `;
            
            // Add to the top of the list
            if (promotionsList.firstChild) {
                promotionsList.insertBefore(promoItem, promotionsList.firstChild);
            } else {
                promotionsList.appendChild(promoItem);
            }
        }
        
        // Mark Promotion as Read
        function markPromotionAsRead(promoId) {
            // In a real app, you would update the promotion record in Supabase
            
            // Find and update the promotion item
            const promotions = document.querySelectorAll('.promotion-item');
            promotions.forEach(promo => {
                if (promo.querySelector('button') && promo.querySelector('button').textContent.includes('markieren')) {
                    promo.classList.remove('unread');
                    promo.querySelector('.promotion-actions').innerHTML = '<span style="color: var(--success);"><i class="fas fa-check"></i> Gelesen</span>';
                }
            });
            
            showNotification('Beförderung als gelesen markiert!');
        }
        
        // Display Ranks
        function displayRanks() {
            const ranksList = document.getElementById('ranks-list');
            ranksList.innerHTML = '';
            
            ranks.forEach((rank, index) => {
                const rankItem = document.createElement('div');
                rankItem.style.padding = '5px 0';
                rankItem.style.borderBottom = '1px solid rgba(255,255,255,0.05)';
                rankItem.textContent = `${index + 1}. ${rank}`;
                ranksList.appendChild(rankItem);
            });
        }
        
        // Function to simulate Supabase connection
        async function testSupabaseConnection() {
            try {
                // This would be your actual Supabase query
                // const { data, error } = await supabase.from('users').select('*').limit(1);
                
                // For now, simulate a successful connection
                return true;
            } catch (error) {
                console.error('Supabase connection error:', error);
                return false;
            }
        }
    </script>
</body>
</html>
